{% extends "home.html" %}
{% load widget_tweaks %}
{% block content %}
<style type="text/css">
	table > * {
		font-size: 20px;
	}
</style>

<div class="container">
<div class="row">
	<div class="col-xs-10">
		<div class="panel panel-success">
			<div class="panel-heading">
				<h3 class="panel-title">
					<span class="glyphicon glyphicon-tag">라벨집계</span>
				</h3>
			</div>
			<div class="panel panel-body">
				<form name="show" method="get" class="form-inline" action="{% url 'orderutils:labelcollect' %}">
					<div id="print-date-info">
					<div class="row">
						<div class="form-group">
							<div class="col-xs-12">
								<label >처방일자:{{ form.ord_start_date }}</label>~
								<label>{{ form.ord_end_date }}</label>
							</div>
						</div>
					</div>
					<div class="row">
						<div class="form-group">
							<div class="col-xs-12">
								<label>접수일시:{{ form.start_t }}</label>~
								<label>{{ form.end_t }}</label>
							</div>
						</div>
					</div>
					<div class="row">
						<div class="form-group">
							<div class="col-xs-12">
								<label>집계병동:{{ form.ward }}</label>
							</div>
						</div>
					</div>
					</div>
					<hr>
					<div class="row" align="center">
						<div class="col-xs-12">
							<div class="btn btn-group">
							<button class="btn btn-success">집계 <span class="glyphicon glyphicon-download-alt"></span></button>
							{% if object_list %}
							<button class="btn btn-success" id="btn-print" type="button">인쇄 <span class="glyphicon glyphicon-print"></span></button>
							{% else %}	
							<button class="btn btn-success disabled" type="button">인쇄 <span class="glyphicon glyphicon-print"></span></button>
							{% endif %}
							</div>
						</div>
					</div>
				</form>
			</div>
			<div class="panel-footer">
				<div class="row">
					{% if object_list %}		
					<table border="1" width="80%">
						<thead>
							<th align="center">약품코드</th>
							<th align="center">약품명</th>
							<th align="center">집계량</th>
							<th align="center">단위</th>
						</thead>
						<tbody>
							{% for object in object_list %}
							<tr>
								<td>{{ object.ord_cd }}</td>
								<td>{{ object.drug_nm }}</td>
								<td align="right">{{ object.ord_qty_sum }}</td>
								<td align="center">{{ object.ord_unit_nm }}</td>
							</tr>
							{% endfor %}
						</tbody>
					</table>
					집계항목이 접수된 시간의 범위
					{{ object_list.0.rcpt_dt_min }} ~ {{ object_list.0.rcpt_dt_max }}
					{% endif %}	
				</div>
			</div>
		</div>
	</div>
</div>
</div>
<script>
$(function(){
	$('#btn-print').click(function(event){
		var printArea = window.open('', 'pop1', 'width=900, height=500, left=400, top=200, scrollbars=no, toolbars=no, location=no')
		printArea.document.write('<head>')
		printArea.document.write($('head').html())
		printArea.document.write('</head>')
		printArea.document.write('<body>')
		printArea.document.write('<div class="container">')
		printArea.document.write('<h2>라벨집계표</h2>')
		printArea.document.write($('#print-date-info').html())
		printArea.document.write($('.panel-footer').html())
		printArea.document.write('</div>')
		printArea.document.write('</body>')
		printArea.document.write('<script>window.print();window.close();<\/script>')
	})
})
</script>

{% endblock content %}


