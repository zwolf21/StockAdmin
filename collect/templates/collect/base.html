{% extends "home.html" %}
{% load static %}

{% block title %}{{ block.super }}|각종집계{% endblock title %}
{% block style %}
<style type="text/css">
	[class^=collect-list], li.collect-list.a {
		cursor: cell;
	}
</style>
{% endblock style %}

{% block content %}
{% block header %}{% endblock header %}
<div class="container-fluid">
	<div class="row">
		<div class="col-xs-3">
			{% block side %}
			<div class="panel panel-warning">
				<div class="panel-heading">
					<h5 class="panel-title">
						<span class="glyphicon glyphicon-scissors"></span>집계내역
					</h5>
				</div>
				<div class="panel-body">
					<div class="row">
						<ul class="list-group">	
							<li class="collect-list-header list-group-item">
								<div class="row">
									<div class="col-xs-2">
										<span class="glyphicon glyphicon-plus"></span>
									</div>
									<div class="col-xs-3">
										<a href="{% url 'collect:create' 'LABEL' %}">라벨</a>
									</div>
									<div class="col-xs-3">
										<a href="{% url 'collect:create' 'INJ' %}">주사</a>
									</div>
									<div class="col-xs-4">
										<a href="{% url 'collect:create' 'NUT' %}">영양수액</a>
									</div>
								</div>
							</li>
						{% for object in object_list %}
							<li class="collect-list list-group-item" url="{% url 'collect:detail' object.slug %}" onclick="location.href='{% url 'collect:detail' object.slug %}'">{{ object.title }}</li>
						{% endfor %}
						</ul>
					</div>
					<div class="row" align="right">
						<div class="col-xs-12">
							{% url 'collect:clear' as clear_url %}
							{% include "includes/delete_one_confirm.html" with url=clear_url id='collect-clear' %}
						</div>
					</div>
				</div>
			</div>
			{% endblock side %}
		</div>
		<div class="col-xs-9">
			<div class="panel with-nav-tabs panel-success">
			    <div class="panel-heading">
			        <ul class="nav nav-tabs">
			        	{% if form %}
				        	{% if form.excludes %}
				            <li class="{% if form.kind.value == 'INJ' %}active{% endif %}"><a href="{% url 'collect:update-plusminus' 'INJ' %}">주사</a></li>
				            <li class="{% if form.kind.value == 'NUT' %}active{% endif %}"><a href="{% url 'collect:update-plusminus' 'NUT' %}">영양수액</a></li>
				            <li class="{% if form.kind.value == 'LABEL' %}active{% endif %}"><a href="{% url 'collect:create' 'LABEL' %}">집계화면</a></li>
				        	{% else %}	
				            <li class="{% if form.kind.value == 'LABEL' %}active{% endif %}"><a href="{% url 'collect:create' 'LABEL' %}">라벨</a></li>
				             <li class="{% if form.kind.value == 'INJ' %}active{% endif %}"><a href="{% url 'collect:create' 'INJ' %}">주사</a></li>
				            <li class="{% if form.kind.value == 'NUT' %}active{% endif %}"><a href="{% url 'collect:create' 'NUT' %}">영양수액</a></li>
				            <li class="">
				                <a href="{% url 'collect:update-plusminus' 'INJ' %}">추가/제외 관리</a>
				            </li>
				        	{% endif %}
				        {% else %}				        
				            <li class="active"><a href="#by-drug" data-toggle="tab">약품별</a></li>
				            <li class=""><a href="#by-ward-drug" data-toggle="tab">병동별</a></li>
				            <li class=""><a href="#by-ward" data-toggle="tab">병동별(상세)</a></li>
			        	{% endif %}
			        </ul>
			    </div>
			    <div class="panel-body">
			        <div class="tab-content">
			        	{% block main %}
			        	{% endblock main %}
			        </div>
			    </div>
			    <div class="panel-footer">
			    	<div class="tab-content">
			    		{% block list %}
			    			
			    		{% endblock list %}
			    	</div>
			    </div>
			</div>
		</div>
	</div>
</div>
<script type="text/javascript">
$(function(){
	
	$('.collect-list').each(function(idx, elem){
		var selected = $(elem)
		var selected_url = selected.attr('url')
		if (selected_url == location.pathname) {
			selected.addClass('list-group-item-warning')
		}
	})	
	// 집계 생성 마법사 화면으로 가기
	$('.collect-list-header').click(function(){
		location.href = "{% url 'collect:create' 'LABEL' %}"
	})
	{% if object %}	
	if (location.pathname == "{% url 'collect:detail' object.slug %}") {
		$('.collect-list-header').addClass('list-group-item-warning')
	}
	{% endif %}
})
</script>
{% endblock content %}